
<!-- hello-chat.html -->
<hello-chat></hello-chat>

<script type="module">
  import tag, { state } from '../../mod.js'
  const $ = tag('hello-chat')
  state['http://invisible.college:3007/messages'] = []

  $.render(() => {
    const messages = state['http://invisible.college:3007/messages'] || []

    const log = messages.map(({ from, body }) => `<div>${from}: ${body}</div>`).join('')

    return `
      ${log}
      <form>
        <input name="message" />
        <button type="submit">Send</button>
      </form>
    `
  })

  $.on('submit', 'form', (event) => {
    event.preventDefault()
    const { value } = event.target.message

    state['http://invisible.college:3007/messages'].push({
      from: 'tyler',
      body: value
    })
  })

</script>
